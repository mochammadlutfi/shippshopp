import j from"./ShippingAddress.js";import{_ as C,A as v,j as c,k as y,l as a,p as t,v as n,s as h,u as w,F as _,a0 as x,$ as g,q as l,E as S}from"./id.js";import{E as L,a as P}from"./index8.js";import{E as T,a as B}from"./index26.js";import"./index20.js";import"./index7.js";import"./typescript.js";import"./index27.js";import"./index28.js";import"./scroll.js";import"./event.js";import"./index21.js";import"./index22.js";import"./_Uint8Array.js";import"./_initCloneObject.js";import"./index29.js";import"./index30.js";import"./isEqual.js";import"./debounce.js";import"./index31.js";const K={components:{ShippingAddress:j},props:{cart:Array,errors:Object},data(){return{product:[],var1:null,var2:null,selected:[],selectAll:!1,address:{},showAll:!0,kurir:null,ongkir:null,layanan:[]}},computed:{totalProduct(){var e=0;return this.selected.forEach((s,i)=>{e+=s.qty}),e},totalHarga(){var e=0;return this.cart.forEach((s,i)=>{e+=s.harga*s.qty}),e},grandTotal(){var e=this.ongkir?this.ongkir.cost:0;return this.totalHarga+e},disablePayment(){return!this.ongkir}},watch:{selectAll:function(e){this.selected=[],e&&this.$page.props.cart.forEach((s,i)=>{this.selected.push(s)})},address(e){if(Object.keys(e).length&&e.distance){let s=(e.distance-5e3)/1e3;this.shippingCost=s*6e3}}},mounted(){this.getAddress()},methods:{async payment(){this.$inertia.form({lines:this.cart,address_id:this.address.id,shipping_cost:this.ongkir.cost,shipping_service:this.ongkir.service,shipping_courirer:this.kurir,shipping_etd:this.ongkir.etd,total:this.totalHarga,grand_total:this.grandTotal}).post(this.route("checkout.store"),{preserveScroll:!0,onSuccess:()=>{}})},async getOngkir(){try{const e=this;this.layanan=[],this.ongkir=null,this.isLoading=!0;const s=await axios.post(this.route("checkout.ongkir"),{city_id:this.address.city_id,kurir:this.kurir,weight:900});if(s.status==200){const i=s.data;this.layanan=[],console.log(i[0]),i[0].costs.forEach((p,r)=>{this.layanan.push({service:p.service,cost:p.cost[0].value,etd:p.cost[0].etd.replace(" HARI","")+" hari"})})}this.isLoading=!1}catch(e){console.error(e)}},async getAddress(){try{this.isLoading=!0;const e=await axios.get("/user/alamat/data",{params:{main:1}});e.status==200&&(this.address=e.data),this.isLoading=!1}catch(e){console.error(e)}},selectKurir(e){console.log(e)},async updatePayment(e,s){try{this.isLoading=!0,(await axios.post(this.route("user.order.state",{id:s}),{status:e})).status==200&&(window.location.href=this.route("user.order.show",{id:s})),this.isLoading=!1}catch(i){console.error(i)}}}},O={class:"content"},q=t("div",{class:"content-heading pt-0 mb-0 border-0 font-size-md"}," Pesanan Kamu ",-1),H={class:"block block-bordered rounded"},N={class:"block-content p-3"},I=["src"],z={class:"fs-5 fw-bold"},R={class:"fs-sm fw-semibold"},U={class:"fs-5 fw-bold text-end"},F=t("span",{class:"fs-6 fw-semibold"},"Tampilkan Semua",-1),J=t("i",{class:"fa fa-angle-small-down"},null,-1),D=t("span",{class:"fs-6 fw-semibold"},"Tampilkan Lebih Sedikit",-1),G=t("i",{class:"fa fa-angle-small-up"},null,-1),M={class:"block-content p-3 text-center border-top border-bottom border-2"},Q={style:{"font-weight":"bold"}},W={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},X=t("div",{class:"content-heading d-flex justify-content-between mb-2 py-2"}," Rincian Belanja ",-1),Y={class:"block block-bordered rounded"},Z={class:"block-content block-content-full"},$={class:"d-flex justify-content-between mb-3"},ee={class:"fs-6"},te={class:"fs-6 fw-bold"},se={class:"d-flex justify-content-between mb-3"},oe=t("div",{class:"fs-6"},"Biaya Kirim",-1),ae={class:"fs-6 fw-bold"},ne={class:"block-content p-4 border-top border-2x"},re={class:"d-flex justify-content-between mb-3"},le=t("div",{class:"fs-5"},"Total Belanja",-1),ie={class:"fs-5 fw-bold"};function ce(e,s,i,p,r,u){const E=v("shipping-address"),d=L,b=P,m=T,k=B,A=S,V=v("base-layout");return c(),y(V,null,{default:a(()=>[t("div",O,[n(b,{gutter:20},{default:a(()=>[n(d,{lg:16},{default:a(()=>[n(E,{modelValue:r.address,"onUpdate:modelValue":s[0]||(s[0]=o=>r.address=o)},null,8,["modelValue"]),q,t("div",H,[t("div",N,[(c(!0),h(_,null,w(i.cart,(o,f)=>(c(),h(_,null,[f==0||!r.showAll?(c(),y(b,{key:o.variant_id,class:"mb-2",gutter:10},{default:a(()=>[n(d,{lg:2},{default:a(()=>[t("img",{src:o.product.main_image,class:"img-fluid"},null,8,I)]),_:2},1024),n(d,{lg:14,class:"my-auto"},{default:a(()=>[t("div",z,l(o.product.name),1),t("div",R,l(e.currency(o.harga))+" x "+l(o.qty)+" barang",1)]),_:2},1024),n(d,{lg:8,class:"my-auto"},{default:a(()=>[t("div",U,l(e.currency(o.harga*o.qty)),1)]),_:2},1024)]),_:2},1024)):x("",!0)],64))),256))]),i.cart.length>1?(c(),h("div",{key:0,class:"block-content p-3 text-center border-top border-bottom border-2",onClick:s[1]||(s[1]=o=>r.showAll=!r.showAll)},[r.showAll?(c(),h(_,{key:0},[F,J],64)):(c(),h(_,{key:1},[D,G],64))])):x("",!0),t("div",M,[n(b,{gutter:20},{default:a(()=>[n(d,{span:12},{default:a(()=>[n(k,{modelValue:r.kurir,"onUpdate:modelValue":s[2]||(s[2]=o=>r.kurir=o),placeholder:"Pilih Kurir",class:"w-100",onChange:u.getOngkir},{default:a(()=>[n(m,{key:"jne",label:"JNE",value:"jne"},{default:a(()=>[g("JNE")]),_:1}),n(m,{key:"pos",label:"POS",value:"pos"},{default:a(()=>[g("POS")]),_:1}),n(m,{key:"tiki",label:"TIKI",value:"tiki"},{default:a(()=>[g("TIKI")]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1}),n(d,{span:12},{default:a(()=>[n(k,{modelValue:r.ongkir,"onUpdate:modelValue":s[3]||(s[3]=o=>r.ongkir=o),"value-key":"service",placeholder:"Pilih Layanan",class:"w-100",disabled:!r.layanan.length,onChange:u.selectKurir},{label:a(({label:o,value:f})=>[t("span",null,l(o)+" ("+l(f.etd)+") : ",1),t("span",Q,l(e.currency(f.cost)),1)]),default:a(()=>[(c(!0),h(_,null,w(r.layanan,o=>(c(),y(m,{key:o.service,label:o.service,value:o},{default:a(()=>[t("span",null,l(o.service)+" - "+l(o.etd),1),t("span",W,l(e.currency(o.cost)),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled","onChange"])]),_:1})]),_:1})])])]),_:1}),n(d,{lg:8},{default:a(()=>[X,t("div",Y,[t("div",Z,[t("div",$,[t("div",ee,"Total Harga ("+l(i.cart.length)+" barang)",1),t("div",te,l(e.currency(u.totalHarga)),1)]),t("div",se,[oe,t("div",ae,l(e.currency(r.ongkir?r.ongkir.cost:0)),1)])]),t("div",ne,[t("div",re,[le,t("div",ie,l(e.currency(u.grandTotal)),1)]),n(A,{type:"primary",size:"large",class:"w-100",onClick:u.payment,disabled:u.disablePayment},{default:a(()=>[g(" Lanjut Ke Pembayaran ")]),_:1},8,["onClick","disabled"])])])]),_:1})]),_:1})])]),_:1})}const Le=C(K,[["render",ce]]);export{Le as default};
