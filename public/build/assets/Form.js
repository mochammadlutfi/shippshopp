import{_ as E,r as M,w as x,A as d,j as A,k as P,l as r,p as i,q as N,v as t,$ as u,a2 as T,E as j}from"./id.js";import{E as c}from"./index20.js";import{E as G}from"./index21.js";import{E as S,a as U}from"./index22.js";import{E as v,a as C}from"./index8.js";import{E as R,a as B}from"./index28.js";import"./index7.js";import"./typescript.js";import"./event.js";import"./_Uint8Array.js";import"./_initCloneObject.js";const D={components:{},setup(){const o=M();return x(o,e=>{e&&e.$mapPromise.then(l=>{})}),{mapRef:o}},props:{data:Object,errors:Object},data(){return{title:"Tambah Alamat",isLoading:!1,map:null,searchQuery:null,mapOptions:{mapTypeControl:!1,streetViewControl:!1,lang:"id"},form:{id:null,name:null,reciever:null,phone:null,address:null,formatted_address:null,lat:null,lng:null,is_main:0},center:{lat:51.093048,lng:6.84212},marker:{lat:51.093048,lng:6.84212}}},mounted(){this.center.lat=this.$page.props.location.lat,this.center.lng=this.$page.props.location.lng,this.marker.lat=this.$page.props.location.lat,this.marker.lng=this.$page.props.location.lng},methods:{setLatLng(){this.form.lat=this.center.lat,this.form.lng=this.center.lng},removeLatLng(){this.form.lat=null,this.form.lng=null},async onDragend(o){try{this.isLoading=!0;const e=await axios.post("/user/alamat/geocode",{latlng:o.latLng.lat()+","+o.latLng.lng()});e.status==200&&(e.data.jarak<=1e4?(this.form.formatted_address=e.data.data,this.center.lat=o.latLng.lat(),this.center.lng=o.latLng.lng(),this.form.lat=o.latLng.lat(),this.form.lng=o.latLng.lng()):c({type:"error",message:"Lokasi Tidak Terjangkau!"})),this.isLoading=!1}catch(e){console.error(e)}},setPlace(o){if(!o.geometry||!o.geometry.location){console.log("Returned place contains no geometry");return}this.center=o.geometry.location,this.form.lat=this.center.lat,this.form.lng=this.center.lng,this.form.formatted_address=o.formatted_address},async getStreetAddressFrom(o,e){try{this.isLoading=!0;const l=await axios.post("/user/alamat/geocode",{latlng:o+","+e});l.status==200&&(l.data.jarak<=1e4?this.form.formatted_address=l.data.data:c({type:"error",message:"Lokasi Tidak Terjangkau!"})),this.isLoading=!1}catch(l){console.error(l)}},submit(){this.isLoading=!0,this.$inertia.form(this.form).post("/user/alamat/store",{preserveScroll:!0,onSuccess:()=>{c({type:"success",message:"Profil berhasil diperbaharui!"})},onFinish:()=>{this.isLoading=!1}})}}},F={class:"d-flex justify-content-between align-items-center mb-3"},O={class:"fs-4 fw-bold mb-0"},H={class:"block rounded"},I={class:"block-content p-4"},q={class:"ep-input mb-3"},z={class:"ep-input__wrapper"};function J(o,e,l,Q,a,p){const g=d("GMapAutocomplete"),h=d("GMapMarker"),b=d("GMapMap"),m=G,s=S,f=v,k=C,_=R,y=B,L=j,V=U,w=d("user-layout");return A(),P(w,null,{default:r(()=>[i("div",F,[i("h3",O,N(a.title),1)]),i("div",H,[i("div",I,[t(V,{"label-position":"top","label-width":"100%",onSubmit:T(p.submit,["prevent"])},{default:r(()=>[i("div",q,[i("div",z,[t(g,{class:"ep-input__inner",placeholder:"Cari Lokasi",onPlace_changed:p.setPlace},null,8,["onPlace_changed"])])]),t(b,{center:a.center,options:a.mapOptions,zoom:14,ref:"mapRef","map-type-id":"roadmap",class:"w-100 mb-4",style:{height:"300px"}},{default:r(()=>[t(h,{position:a.center,draggable:!0,onDragend:p.onDragend},null,8,["position","onDragend"])]),_:1},8,["center","options"]),t(s,{label:"Alamat Berdasarkan Titik",error:l.errors.phone},{default:r(()=>[t(m,{modelValue:a.form.formatted_address,"onUpdate:modelValue":e[0]||(e[0]=n=>a.form.formatted_address=n),type:"textarea",rows:2,readonly:!0},null,8,["modelValue"])]),_:1},8,["error"]),t(s,{label:"Alamat Lengkap",error:l.errors.phone},{default:r(()=>[t(m,{modelValue:a.form.address,"onUpdate:modelValue":e[1]||(e[1]=n=>a.form.address=n),type:"textarea",rows:2,placeholder:"Masukan Alamat"},null,8,["modelValue"])]),_:1},8,["error"]),t(s,{label:"Nama Alamat",error:l.errors.name},{default:r(()=>[t(m,{modelValue:a.form.name,"onUpdate:modelValue":e[2]||(e[2]=n=>a.form.name=n),type:"text",placeholder:"Masukan Nama Alamat"},null,8,["modelValue"])]),_:1},8,["error"]),t(k,{gutter:20},{default:r(()=>[t(f,{span:12},{default:r(()=>[t(s,{label:"Nama Penerima",error:l.errors.name},{default:r(()=>[t(m,{modelValue:a.form.reciever,"onUpdate:modelValue":e[3]||(e[3]=n=>a.form.reciever=n),type:"text",placeholder:"Masukan Nama Penerima"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1}),t(f,{span:12},{default:r(()=>[t(s,{label:"No HP Penerima",error:l.errors.phone},{default:r(()=>[t(m,{modelValue:a.form.phone,"onUpdate:modelValue":e[4]||(e[4]=n=>a.form.phone=n),type:"text",placeholder:"Masukan No Handphone"},null,8,["modelValue"])]),_:1},8,["error"])]),_:1})]),_:1}),t(s,{label:"Jadikan Alamat Utama?"},{default:r(()=>[t(y,{modelValue:a.form.is_main,"onUpdate:modelValue":e[5]||(e[5]=n=>a.form.is_main=n)},{default:r(()=>[t(_,{label:1,border:""},{default:r(()=>[u("Ya")]),_:1}),t(_,{label:0,border:""},{default:r(()=>[u("Tidak")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(L,{"native-type":"submit",type:"primary",class:"w-100",loading:a.isLoading},{default:r(()=>[u(" Simpan ")]),_:1},8,["loading"])]),_:1},8,["onSubmit"])])])]),_:1})}const le=E(D,[["render",J]]);export{le as default};
