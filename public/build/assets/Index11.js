import j from"./UnitSelect.js";import{h as U}from"./moment.js";import{_ as I,A as N,j as c,k as h,l as t,p as l,$ as m,a0 as f,v as e,a2 as g,s as z,q as b,a3 as A,E as L,B as P,x as Y,y as O}from"./id.js";import{E as v}from"./index20.js";import{E as q}from"./index29.js";import{a as H,E as R}from"./index32.js";import{E as G,a as J}from"./index8.js";import{E as Q}from"./index21.js";import{E as W,a as X}from"./index31.js";import{E as Z}from"./index34.js";import{E as $,a as ee}from"./index22.js";import{E as te}from"./index26.js";import{v as oe}from"./directive.js";import"./typescript.js";import"./event.js";import"./index30.js";import"./isEqual.js";import"./_Uint8Array.js";import"./scroll.js";import"./debounce.js";import"./index33.js";import"./index7.js";import"./index27.js";import"./index23.js";import"./_initCloneObject.js";const ae={components:{UnitSelect:j},props:{errors:Object},data(){return{selected:[],data:[],from:0,to:0,isLoading:!0,page:1,pageSize:0,searchKey:"nama",searchKeyword:"",limit:25,total:0,showForm:!1,sort:"nama",sortDir:"ASC",formTitle:"Tambah Kategori",form:{id:null,nama:null},editMode:!1,loadingForm:!1,loadingImport:!1,showImport:!1,importFile:null}},async created(){await this.fetchData()},methods:{indexMethod(s){return(this.page==1?1:this.limit*(this.page-1)+1)+s},sortChange(s){this.sort=s.prop,this.sortDir=s.order=="ascending"?"ASC":"DESC",this.fetchData()},async fetchData(o){var o=o??1;try{this.isLoading=!0;const n=await axios.get("/admin/kategori/data",{params:{page:o,limit:this.limit,sort:this.sort,sortDir:this.sortDir,search:this.searchKeyword,searchKey:this.searchKey}});n.status==200&&(this.from=n.data.from,this.to=n.data.to,this.data=n.data.data,this.page=n.data.current_page,this.total=n.data.total,this.pageSize=n.data.per_page),this.isLoading=!1}catch(n){console.error(n)}},format_date(s){if(s)return U(String(s)).format("DD MMMM YYYY")},onCloseForm(){this.title="Tambah Kategori",this.editMode=!1,this.form.id=null,this.form.nama=null,this.form.phone=null,this.showForm=!1},submit(){this.loadingForm=!0;let s=this.$inertia.form(this.form),o=this.editMode==!0?this.route("admin.inventory.category.update",{id:this.form.id}):this.route("admin.inventory.category.store");s.post(o,{preserveScroll:!0,onFinish:()=>{this.loadingForm=!1},onSuccess:()=>{v({type:"success",message:"Data Berhasil Disimpan!"}),this.onCloseForm(),this.fetchData()}})},edit(s){this.formTitle="Ubah Kategori",this.form.id=s.id,this.form.nama=s.nama,this.editMode=!0,this.showForm=!0},hapus(s){q.alert("Data yang dihapus tidak bisa dikembalikan!","Peringatan",{showCancelButton:!0,confirmButtonText:"Ya!",cancelButtonText:"Tidak!",type:"warning"}).then(()=>{this.$inertia.delete(this.route("admin.inventory.category.delete",{id:s}),{preserveScroll:!0,onSuccess:()=>{this.fetchData(),v({type:"success",message:"Data Berhasil Dihapus!"})}})})}}},se={class:"content"},le={class:"content-heading d-flex justify-content-between align-items-center"},ie=l("span",null,"Kategori Produk",-1),ne={class:"space-x-1"},re=l("i",{class:"fa fa-plus me-1"},null,-1),me={class:"block rounded"},ce={class:"block-content py-3"},de=l("i",{class:"fa fa-search"},null,-1),pe={class:"block-content p-0"},ue=l("i",{class:"fa fa-angle-down ms-1"},null,-1),he=l("i",{class:"si fa-fw si-note"},null,-1),_e=l("i",{class:"si fa-fw si-trash"},null,-1),fe={key:0,class:"block-content py-2"},ge={class:"mb-0"},be={class:"text-end"},ye=l("i",{class:"si si-close me-1"},null,-1),we=l("i",{class:"si si-check me-1"},null,-1);function ke(s,o,n,ve,a,r){const d=L,_=H,C=R,p=G,y=Q,w=J,u=W,k=P,E=Y,x=O,D=X,S=Z,F=$,V=ee,M=te,B=N("base-layout"),T=oe;return c(),h(B,null,{default:t(()=>[l("div",se,[l("div",le,[ie,l("div",ne,[s.$page.props.user.level!="kasir 2"?(c(),h(d,{key:0,onClick:o[0]||(o[0]=i=>a.showForm=!0),type:"primary"},{default:t(()=>[re,m(" Tambah ")]),_:1})):f("",!0)])]),l("div",me,[l("div",ce,[e(w,{justify:"space-between"},{default:t(()=>[e(p,{span:12},{default:t(()=>[e(C,{modelValue:a.limit,"onUpdate:modelValue":o[1]||(o[1]=i=>a.limit=i),placeholder:"Pilih",style:{width:"115px"},onChange:o[2]||(o[2]=i=>r.fetchData(1))},{default:t(()=>[e(_,{label:"25",value:"25"}),e(_,{label:"50",value:"50"}),e(_,{label:"100",value:"100"})]),_:1},8,["modelValue"])]),_:1}),e(p,{span:8},{default:t(()=>[e(y,{modelValue:a.searchKeyword,"onUpdate:modelValue":o[3]||(o[3]=i=>a.searchKeyword=i),placeholder:"Masukan kata kunci",class:"input-with-select",clearable:""},{prefix:t(()=>[de]),_:1},8,["modelValue"])]),_:1})]),_:1})]),l("div",pe,[e(D,{data:a.data,class:"w-100",onSortChange:r.sortChange,"header-cell-class-name":"bg-primary text-dark"},{default:t(()=>[e(u,{type:"index",width:"100"}),e(u,{prop:"nama",label:"Nama",sortable:""}),e(u,{prop:"product_count",label:"Total Produk",sortable:""}),s.$page.props.user.level!="kasir 2"?(c(),h(u,{key:0,label:"Aksi",align:"center",width:"180"},{default:t(i=>[e(x,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:t(()=>[e(E,null,{default:t(()=>[e(k,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:g(K=>r.edit(i.row),["prevent"])},{default:t(()=>[m(" Ubah "),he]),_:2},1032,["onClick"]),e(k,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:g(K=>r.hapus(i.row.id),["prevent"])},{default:t(()=>[m(" Hapus "),_e]),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[e(d,{type:"primary"},{default:t(()=>[m(" Aksi "),ue]),_:1})]),_:2},1024)]),_:1})):f("",!0)]),_:1},8,["data","onSortChange"])]),a.isLoading==!1?(c(),z("div",fe,[e(w,{justify:"space-between"},{default:t(()=>[e(p,{lg:12},{default:t(()=>[l("p",ge,"Menampilkan "+b(a.from)+" sampai "+b(a.to)+" dari "+b(a.total),1)]),_:1}),e(p,{lg:12,class:"text-end"},{default:t(()=>[e(S,{class:"float-end",background:"",layout:"prev, pager, next","page-size":a.pageSize,total:a.total,"current-page":a.page,onCurrentChange:r.fetchData},null,8,["page-size","total","current-page","onCurrentChange"])]),_:1})]),_:1})])):f("",!0)])]),e(M,{modelValue:a.showForm,"onUpdate:modelValue":o[5]||(o[5]=i=>a.showForm=i),title:a.formTitle,width:"30%",class:"rounded-2","before-close":r.onCloseForm,"close-on-click-modal":!1},{default:t(()=>[A((c(),h(V,{model:a.form,"label-position":"top",onSubmit:g(r.submit,["prevent"])},{default:t(()=>[e(F,{label:"Nama Kategori",error:n.errors.nama},{default:t(()=>[e(y,{modelValue:a.form.nama,"onUpdate:modelValue":o[4]||(o[4]=i=>a.form.nama=i)},null,8,["modelValue"])]),_:1},8,["error"]),l("div",be,[e(d,{onClick:r.onCloseForm},{default:t(()=>[ye,m(" Batal ")]),_:1},8,["onClick"]),e(d,{type:"primary","native-type":"submit"},{default:t(()=>[we,m(" Simpan ")]),_:1})])]),_:1},8,["model","onSubmit"])),[[T,a.loadingForm]])]),_:1},8,["modelValue","title","before-close"])]),_:1})}const Je=I(ae,[["render",ke]]);export{Je as default};
