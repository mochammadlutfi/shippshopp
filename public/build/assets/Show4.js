import{h as R}from"./moment.js";import{R as T,i as Q,ax as H,T as W,a3 as x,O as M,aZ as ee,a9 as F,at as te,U as h,j as p,s as v,p as r,F as E,u as z,k as C,v as a,V as G,aa as ae,af as le,S as se,ao as oe,f as ne,H as B,G as O,$ as _,q as b,a0 as j,X as re,Y as ie,_ as de,A as ce,l as s,a2 as U,E as ue}from"./id.js";import{E as K}from"./index20.js";import{E as pe}from"./index29.js";import{g as me,f as fe}from"./index27.js";import{E as _e,a as be}from"./index30.js";import{E as he,a as ye}from"./index8.js";import{E as ge}from"./index21.js";import{E as ve,a as we}from"./index22.js";import{E as De}from"./index35.js";import{E as Se}from"./index24.js";import{E as ke}from"./index26.js";import"./index7.js";import"./typescript.js";import"./scroll.js";import"./index31.js";import"./_Uint8Array.js";import"./isEqual.js";import"./debounce.js";import"./index23.js";import"./event.js";import"./_initCloneObject.js";import"./index25.js";const A=Symbol("elDescriptions");var I=T({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:Q(A,{})}},render(){var o,t,l,P,i,u,w;const m=me(this.cell),n=(((o=this.cell)==null?void 0:o.dirs)||[]).map(k=>{const{dir:X,arg:Z,modifiers:J,value:$}=k;return[X,$,Z,J]}),{border:d,direction:f}=this.descriptions,c=f==="vertical",D=((P=(l=(t=this.cell)==null?void 0:t.children)==null?void 0:l.label)==null?void 0:P.call(l))||m.label,y=(w=(u=(i=this.cell)==null?void 0:i.children)==null?void 0:u.default)==null?void 0:w.call(u),g=m.span,V=m.align?`is-${m.align}`:"",S=m.labelAlign?`is-${m.labelAlign}`:V,N=m.className,q=m.labelClassName,Y={width:H(m.width),minWidth:H(m.minWidth)},e=W("descriptions");switch(this.type){case"label":return x(M(this.tag,{style:Y,class:[e.e("cell"),e.e("label"),e.is("bordered-label",d),e.is("vertical-label",c),S,q],colSpan:c?g:1},D),n);case"content":return x(M(this.tag,{style:Y,class:[e.e("cell"),e.e("content"),e.is("bordered-content",d),e.is("vertical-content",c),V,N],colSpan:c?g:g*2-1},y),n);default:return x(M("td",{style:Y,class:[e.e("cell"),V],colSpan:g},[ee(D)?void 0:M("span",{class:[e.e("label"),q]},D),M("span",{class:[e.e("content"),N]},y)]),n)}}});const Ee=F({row:{type:te(Array),default:()=>[]}}),Ve={key:1},Ce=T({name:"ElDescriptionsRow"}),Pe=T({...Ce,props:Ee,setup(o){const t=Q(A,{});return(l,P)=>h(t).direction==="vertical"?(p(),v(E,{key:0},[r("tr",null,[(p(!0),v(E,null,z(l.row,(i,u)=>(p(),C(h(I),{key:`tr1-${u}`,cell:i,tag:"th",type:"label"},null,8,["cell"]))),128))]),r("tr",null,[(p(!0),v(E,null,z(l.row,(i,u)=>(p(),C(h(I),{key:`tr2-${u}`,cell:i,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(p(),v("tr",Ve,[(p(!0),v(E,null,z(l.row,(i,u)=>(p(),v(E,{key:`tr3-${u}`},[h(t).border?(p(),v(E,{key:0},[a(h(I),{cell:i,tag:"td",type:"label"},null,8,["cell"]),a(h(I),{cell:i,tag:"td",type:"content"},null,8,["cell"])],64)):(p(),C(h(I),{key:1,cell:i,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var Ne=G(Pe,[["__file","descriptions-row.vue"]]);const Be=F({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:ae,title:{type:String,default:""},extra:{type:String,default:""}}),Te=T({name:"ElDescriptions"}),Ye=T({...Te,props:Be,setup(o){const t=o,l=W("descriptions"),P=le(),i=se();oe(A,t);const u=ne(()=>[l.b(),l.m(P.value)]),w=(n,d,f,c=!1)=>(n.props||(n.props={}),d>f&&(n.props.span=f),c&&(n.props.span=d),n),m=()=>{if(!i.default)return[];const n=fe(i.default()).filter(y=>{var g;return((g=y==null?void 0:y.type)==null?void 0:g.name)==="ElDescriptionsItem"}),d=[];let f=[],c=t.column,D=0;return n.forEach((y,g)=>{var V;const S=((V=y.props)==null?void 0:V.span)||1;if(g<n.length-1&&(D+=S>c?c:S),g===n.length-1){const N=t.column-D%t.column;f.push(w(y,N,c,!0)),d.push(f);return}S<c?(c-=S,f.push(y)):(f.push(w(y,S,c)),d.push(f),c=t.column,f=[])}),d};return(n,d)=>(p(),v("div",{class:B(h(u))},[n.title||n.extra||n.$slots.title||n.$slots.extra?(p(),v("div",{key:0,class:B(h(l).e("header"))},[r("div",{class:B(h(l).e("title"))},[O(n.$slots,"title",{},()=>[_(b(n.title),1)])],2),r("div",{class:B(h(l).e("extra"))},[O(n.$slots,"extra",{},()=>[_(b(n.extra),1)])],2)],2)):j("v-if",!0),r("div",{class:B(h(l).e("body"))},[r("table",{class:B([h(l).e("table"),h(l).is("bordered",n.border)])},[r("tbody",null,[(p(!0),v(E,null,z(m(),(f,c)=>(p(),C(Ne,{key:c,row:f},null,8,["row"]))),128))])],2)],2)],2))}});var Me=G(Ye,[["__file","description.vue"]]);const Ie=F({label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),L=T({name:"ElDescriptionsItem",props:Ie}),je=re(Me,{DescriptionsItem:L}),qe=ie(L),Ue={props:{data:{type:Object,default:{}},errors:Object},data(){return{modalConfirm:!1,form:{date:R().format("YYYY-MM-DD"),ref:null},lines:[]}},mounted(){this.setInitValue()},methods:{formatDate(o){return R.locale("id"),R(o).locale("id").format("DD MMMM YYYY")},disabledDate(o){var t=new Date;return t.setDate(t.getDate()-1),o<t},setInitValue(){this.data.lines.forEach((o,t)=>{this.lines.push({id:o.id,product:o.product.nama,product_id:o.product_id,price:o.price,qty:o.qty,qty_receipt:o.qty,subtotal:o.subtotal})})},submit(){this.loading=!0;let o={ref:this.form.ref,date:this.form.date,state:"done",lines:this.lines},t=this.$inertia.form(o),l=this.route("admin.purchase.order.state",{id:this.data.id});t.post(l,{preserveScroll:!0,onSuccess:()=>{K({type:"success",message:"Data Berhasil Disimpan!"}),this.modalConfirm=!1},onFinish:()=>{this.loading=!1}})},updateState(o){let t="";o=="pending"?t="Setuju Pengajuan Pembelian ?":o=="done"?t="Terima Barang Pembelian ?":t="Tolak Pengajuan Pembelian?",pe.alert(t,"Peringatan",{showCancelButton:!0,confirmButtonText:"Ya!",cancelButtonText:"Tidak!",type:"warning"}).then(()=>{this.$inertia.post(this.route("admin.purchase.order.state",{id:this.data.id}),{state:o},{preserveScroll:!0,onSuccess:()=>{this.fetchData(),K({type:"success",message:"Data Berhasil Diperbaharui!"})}})})}}},ze={class:"content"},Re={class:"content-heading d-flex justify-content-between align-items-center"},xe=r("div",{class:"my-auto"}," Detail Pesanan Pembelian ",-1),Fe={class:"float-end"},Ae=r("i",{class:"fa fa-check me-2"},null,-1),He=r("i",{class:"fa fa-check me-2"},null,-1),Oe=r("i",{class:"fa fa-close me-2"},null,-1),Ke={class:"block block-bordered rounded"},Qe={class:"block-content p-4"},We={class:"fs-3 fw-bold"},Ge={class:"d-flex float-end justify-content-end w-75 fs-4"},Le=r("div",{class:""},"Total",-1),Xe={class:"text-end w-50"},Ze={class:"border-top pt-2 text-end"},Je=r("i",{class:"fa fa-check me-2"},null,-1);function $e(o,t,l,P,i,u){const w=ue,m=qe,n=je,d=_e,f=be,c=he,D=ye,y=ge,g=ve,V=De,S=Se,N=we,q=ke,Y=ce("base-layout");return p(),C(Y,null,{default:s(()=>[r("div",ze,[r("div",Re,[xe,r("div",Fe,[l.data.state=="pending"?(p(),C(w,{key:0,type:"primary",onClick:t[0]||(t[0]=U(e=>u.updateState("done"),["prevent"]))},{default:s(()=>[Ae,_(" Terima Barang ")]),_:1})):j("",!0),l.data.state=="draft"?(p(),v(E,{key:1},[a(w,{type:"primary",onClick:t[1]||(t[1]=U(e=>u.updateState("pending"),["prevent"]))},{default:s(()=>[He,_(" Setuju ")]),_:1}),a(w,{type:"primary",plain:"",onClick:t[2]||(t[2]=U(e=>u.updateState("cancel"),["prevent"]))},{default:s(()=>[Oe,_(" Batal ")]),_:1})],64)):j("",!0)])]),r("div",Ke,[r("div",Qe,[r("h3",We,b(l.data.nomor),1),a(n,{column:"2"},{default:s(()=>[a(m,{label:"Supplier"},{default:s(()=>[_(b(l.data.supplier.nama),1)]),_:1}),a(m,{label:"No Handphone"},{default:s(()=>[_(b(l.data.supplier.hp),1)]),_:1}),a(m,{label:"Tanggal Pembelian"},{default:s(()=>[_(b(u.formatDate(l.data.date)),1)]),_:1}),l.data.state=="done"?(p(),C(m,{key:0,label:"Tanggal Terima"},{default:s(()=>[_(b(u.formatDate(l.data.date_received)),1)]),_:1})):j("",!0)]),_:1}),a(f,{data:l.data.lines,border:"",id:"variant",class:"mb-2"},{default:s(()=>[a(d,{label:"Produk"},{default:s(e=>[r("div",null,b(e.row.product.nama),1)]),_:1}),a(d,{label:"Harga"},{default:s(e=>[_(b(o.currency(e.row.price)),1)]),_:1}),a(d,{prop:"qty",label:"Qty Dipesan"}),a(d,{label:"Total"},{default:s(e=>[_(b(o.currency(e.row.subtotal)),1)]),_:1})]),_:1},8,["data"]),a(D,{justify:"end"},{default:s(()=>[a(c,{lg:12,class:"float-end"},{default:s(()=>[r("div",Ge,[Le,r("div",Xe,b(o.currency(l.data.total)),1)])]),_:1})]),_:1})])])]),a(q,{modelValue:i.modalConfirm,"onUpdate:modelValue":t[6]||(t[6]=e=>i.modalConfirm=e),title:"Konfirmasi Pembelian Produk?",width:"800px"},{default:s(()=>[a(N,{onSubmit:U(u.submit,["prevent"]),"label-position":"top"},{default:s(()=>[a(D,{gutter:32},{default:s(()=>[a(c,{lg:12},{default:s(()=>[a(g,{class:"mb-4",label:"Faktur Supplier"},{default:s(()=>[a(y,{modelValue:i.form.ref,"onUpdate:modelValue":t[3]||(t[3]=e=>i.form.ref=e)},null,8,["modelValue"])]),_:1})]),_:1}),a(c,{lg:12},{default:s(()=>[a(g,{class:"mb-4",label:"Tanggal",error:l.errors.date},{default:s(()=>[a(V,{modelValue:i.form.date,"onUpdate:modelValue":t[4]||(t[4]=e=>i.form.date=e),type:"date",class:"w-100",placeholder:"Pilih Tanggal",format:"DD MMMM YYYY","value-format":"YYYY-MM-DD","disabled-date":u.disabledDate},null,8,["modelValue","disabled-date"])]),_:1},8,["error"])]),_:1})]),_:1}),a(f,{data:i.lines,border:"",id:"variant",class:"mb-2",style:{width:"100%"}},{default:s(()=>[a(d,{label:"Produk",width:"210"},{default:s(e=>[r("div",null,[_(b(e.row.product)+" ",1),e.row.variant?(p(),v(E,{key:0},[_(" - "+b(e.row.variant),1)],64)):j("",!0)])]),_:1}),a(d,{label:"Harga Beli",width:"150"},{default:s(e=>[a(y,{modelValue:e.row.price,"onUpdate:modelValue":k=>e.row.price=k,formatter:k=>`Rp ${k}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:k=>k.replace(/^Rp\s+|(\,)/gi,"")},null,8,["modelValue","onUpdate:modelValue","formatter","parser"])]),_:1}),a(d,{label:"Satuan",width:"110"},{default:s(e=>[_(b(e.row.unit)+" ("+b(e.row.unit_code)+") ",1)]),_:1}),a(d,{prop:"qty",label:"Qty Dipesan",width:"110"}),a(d,{label:"Qty Diterima",width:"140"},{default:s(e=>[a(S,{modelValue:e.row.qty_receipt,"onUpdate:modelValue":k=>e.row.qty_receipt=k,min:0,class:"w-100"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"]),r("div",Ze,[a(w,{onClick:t[5]||(t[5]=e=>i.modalConfirm=!1)},{default:s(()=>[_("Batal")]),_:1}),a(w,{"native-type":"submit",type:"primary"},{default:s(()=>[Je,_(" Simpan ")]),_:1})])]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})}const St=de(Ue,[["render",$e]]);export{St as default};
